function request(b,c,a,d,g){null==d&&(d="result");if(!0==/.htm?/.test(a)){for(var a=a.split(".htm?"),f="",h=0;h<a.length;h++)f=f+a[h]+"&";a=f}document.getElementById(d).innerHTML='<img src="/js/img/loader.gif" style="vertical-align:middle" />';var e=new JsHttpRequest;e.onreadystatechange=function(){4==e.readyState&&e.responseJS&&(document.getElementById(d).innerHTML=e.responseText,runScripts(document.getElementById(d).getElementsByTagName("SCRIPT")))};e.caching=!1;e.loader=b;e.open(c,"loader.php"+ a,!0);a={q:a,data2:g};null==g&&delete a.data2;e.send(a)} function getdata(b,c,a,d,g){null==d&&(d="result");if(!0==/.htm?/.test(a)){for(var a=a.split(".htm?"),f="",h=0;h<a.length;h++)f=f+a[h]+"&";a="?p="+f}"ActionRes"==d&&(document.getElementById("ARC").style.display="block");document.getElementById(d).innerHTML='<img src="/js/img/loader.gif" style="vertical-align:middle" />';var e=new JsHttpRequest;e.onreadystatechange=function(){if(e.readyState==4&&e.responseJS){document.getElementById(d).innerHTML=e.responseText;runScripts(document.getElementById(d).getElementsByTagName("SCRIPT"))}}; e.caching=!1;e.loader=b;e.open(c,"loader.php"+a,!0);a={q:a,data2:g};null==g&&delete a.data2;e.send(a)} function appenddata(b,c,a,d,g){null==d&&(d="result");if(!0==/.htm?/.test(a)){for(var a=a.split(".htm?"),f="",h=0;h<a.length;h++)f=f+a[h]+"&";a="?p="+f}var e=new JsHttpRequest;e.onreadystatechange=function(){4==e.readyState&&e.responseJS&&(document.getElementById(d).innerHTML+=e.responseText,runScripts(document.getElementById(d).getElementsByTagName("SCRIPT")))};e.caching=!1;e.loader=b;e.open(c,"loader.php"+a,!0);a={q:a,data2:g};null==g&&delete a.data2;e.send(a)} function doLoad(b,c){"ActionRes"==c&&(document.getElementById("ARC").style.display="block");document.getElementById(c).innerHTML='<img src="/js/img/loader.gif" style="vertical-align:middle;" />';var a=new JsHttpRequest;a.onreadystatechange=function(){if(a.readyState==4){document.getElementById(c).innerHTML=a.responseText;runScripts(document.getElementById(c).getElementsByTagName("SCRIPT"))}};a.open(null,"loader.php",!0);a.send({form:document.getElementById(b)})} function checkLen1(b,c,a){var d=document.getElementById(b).value,g=d.length,f=c-g;c<g&&(document.getElementById(b).value=d.substring(0,c));g<c-1?document.getElementById(a).innerHTML="\u041e\u0441\u0442\u0430\u043b\u043e\u0441\u044c: "+f:document.getElementById(a).innerHTML="<br>\u0422\u0435\u043a\u0441\u0442 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0434\u043b\u0438\u043d\u043d\u0435\u0435, \u0447\u0435\u043c "+c+" \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432!"} function runScripts(b){if(!b)return!1;for(var c=0;c<b.length;c++){var a=b[c];if(a.src){var d=document.createElement("script");d.type=a.type;d.language=a.language;d.src=a.src;document.body.appendChild(d)}else if(a=a.text||a.innerHTML)a=(""+a).replace(/^\s*<!\-\-/,"").replace(/\-\->\s*$/,""),eval(a)}}function HideObject(b){document.getElementById(b).style.display="none"}function ShowObject(b){document.getElementById(b).style.display="block"} function getElementsByClass(b,c,a){var d=[];null==c&&(c=document);null==a&&(a="*");c=c.getElementsByTagName(a);a=c.length;b=RegExp("(^|\\s)"+b+"(\\s|$)");for(j=i=0;i<a;i++)b.test(c[i].className)&&(d[j]=c[i],j++);return d}function setall(b){b=getElementsByClass(b,null,"input");for(i=0;i<b.length;i++)b[i].checked=!0==b[i].checked?!1:!0} function SwitchShow(b){"none"==document.getElementById(b).style.display?document.getElementById(b).style.display="block":document.getElementById(b).style.display="none"}function delelem(b){b=document.getElementById(b);b.parentNode.removeChild(b)}function ShowDebug(b){document.getElementById("debug").innerHTML=b}function ChangeSelDate(b){var c=getElementsByClass("seld",null,"a");for(i=0;i<c.length;i++)c[i].className="cur";b.className="seld"} function add_file(b,c){-1==document.getElementById(b+"_"+c).innerHTML.search("uploadinputbutton")&&(document.getElementById(b+"_"+c).innerHTML='<input type="file" class="uploadinputbutton" name="'+b+'[]" onchange="return add_file(\''+b+"', "+(c+1)+');" /><br /><span id="'+b+"_"+(c+1)+'"><input type="button" value="\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0434\u0440\u0443\u0433\u043e\u0439" onclick="add_file(\''+b+"', "+(c+1)+');" /></span>\n')} function CloseInfo(){document.getElementById("ActionRes").innerHTML="";document.getElementById("ARC").style.display="none"} function doLoadPagePhoto(b,c){document.getElementById("ARC").style.display="block";document.getElementById(c).innerHTML='<img src="/js/img/loader.gif" style="vertical-align:middle;" />';JsHttpRequest.query("loader.php",{form:document.getElementById(b),p:"admin_list_action",act:"UploadPhoto"},function(a){a?"ERROR"==a.state?document.getElementById(c).innerHTML=a.msg:(document.getElementById(c).innerHTML=a.msg,a='<div style="float:left; padding:2px; margin:2px;text-align:center;" id="PID'+a.photo_id+ '"><small>\u0413\u0430\u043b\u0435\u0440\u0435\u044f:</small>'+a.photo_group+"<br />"+a.psign+'<br /><a href="'+a.bigphoto+'" target="_bigphoto"><img src="'+a.thumb+'" height="50" /></a><br /><a href="javascript:void(null)" onclick="getdata(\'\',\'post\',\'?p=admin_list_action&act=DeletePhoto&photo_id='+a.photo_id+"','PhotoMsg'); delelem('PID"+a.photo_id+"');\">\u0423\u0434\u0430\u043b\u0438\u0442\u044c</a></div>",$("#PhotoList").append(a)):alert("error")},!0)} function doLoadUserPagePhoto(b,c){JsHttpRequest.query("loader.php",{form:document.getElementById(b),p:"site_server",act:"UploadUserPhoto"},function(a){a?"ERROR"==a.state?document.getElementById(c).innerHTML=a.msg:(document.getElementById(c).innerHTML=a.msg,a='<div style="float:left; padding:2px; margin:2px;text-align:center;" id="PID'+a.photo_id+'"><small>\u0413\u0430\u043b\u0435\u0440\u0435\u044f:</small>'+a.photo_group+"<br />"+a.psign+'<br /><a href="'+a.bigphoto+'" target="_bigphoto"><img src="'+ a.thumb+'" height="50" /></a><br /><a href="javascript:void(null)" onclick="getdata(\'\',\'post\',\'?p=site_server&act=DeletePhoto&photo_id='+a.photo_id+"','PhotoMsg'); delelem('PID"+a.photo_id+"');\">\u0423\u0434\u0430\u043b\u0438\u0442\u044c</a></div>",$("#PhotoList").prepend(a)):alert("error")},!0)} function doLoadUserPageVideo(b,c){JsHttpRequest.query("loader.php",{form:document.getElementById(b),p:"site_server",act:"UploadUserVideo"},function(a){a?"ERROR"==a.state?document.getElementById(c).innerHTML=a.msg:(document.getElementById(c).innerHTML=a.msg,a='<div style="padding:2px;" id="VID'+a.video_id+'">\u0412\u0438\u0434\u0435\u043e:'+a.video_group+". <a href=\"javascript:void(null)\" onclick=\"getdata('','post','?p=site_server&act=EditUserVideo&video_id="+a.video_id+"','EDV"+a.video_id+"');\">"+ a.video_id+": "+a.vsign+"</a> | <a href=\"javascript:void(null)\" onclick=\"getdata('','post','?p=site_server&act=DeleteUserVideo&video_id="+a.video_id+"','VideoMsg'); delelem('VID"+a.video_id+"');\">\u0423\u0434\u0430\u043b\u0438\u0442\u044c</a></div>",$("#VideoList").append(a)):alert("error")},!0)} function doLoadUserPageVideo1(b,c,a){JsHttpRequest.query("loader.php",{form:document.getElementById(b),p:"site_server",act:"UploadUserVideo1"},function(b){b?"ERROR"==b.state?document.getElementById(c).innerHTML=b.msg:(document.getElementById(c).innerHTML=b.msg,document.getElementById(a).innerHTML=""):alert("error")},!0)};

/* LGPL @author Dmitry Koterov, http://en.dklab.ru/lib/JsHttpRequest/ @version 5.x $Id$ */
function JsHttpRequest(){this.onreadystatechange=null;this.readyState=0;this.responseXML=this.responseText=null;this.status=200;this.statusText="OK";this.responseJS=null;this.caching=!1;this.loader=null;this.session_name="PHPSESSID";this._ldObj=null;this._reqHeaders=[];this._openArgs=null;this._errors={inv_form_el:"Invalid FORM element detected: name=%, tag=%",must_be_single_el:"If used, <form> must be a single HTML element in the list.",js_invalid:"JavaScript code generated by backend is invalid!\n%", url_too_long:"Cannot use so long query with GET request (URL is larger than % bytes)",unk_loader:"Unknown loader: %",no_loaders:"No loaders registered at all, please check JsHttpRequest.LOADERS array",no_loader_matched:"Cannot find a loader which may process the request. Notices are:\n%"};this.abort=function(){with(this){_ldObj&&_ldObj.abort&&_ldObj.abort();_cleanup();if(0==readyState)return;if(1==readyState&&!_ldObj){readyState=0;return}_changeReadyState(4,!0)}};this.open=function(a,b,d,c,e){with(this){b.match(/^((\w+)\.)?(GET|POST)\s+(.*)/i)&& (this.loader=RegExp.$2?RegExp.$2:null,a=RegExp.$3,b=RegExp.$4);try{if(document.location.search.match(RegExp("[&?]"+session_name+"=([^&?]*)"))||document.cookie.match(RegExp("(?:;|^)\\s*"+session_name+"=([^;]*)")))b+=(0<=b.indexOf("?")?"&":"?")+session_name+"="+this.escape(RegExp.$1)}catch(f){}_openArgs={method:(a||"").toUpperCase(),url:b,asyncFlag:d,username:null!=c?c:"",password:null!=e?e:""};_ldObj=null;_changeReadyState(1,!0);return!0}};this.send=function(a){if(this.readyState){this._changeReadyState(1, !0);this._ldObj=null;var b=[],d=[];if(this._hash2query(a,null,b,d)){a=null;if(this.caching&&!d.length){var a=this._openArgs.username+":"+this._openArgs.password+"@"+this._openArgs.url+"|"+b+"#"+this._openArgs.method,c=JsHttpRequest.CACHE[a];if(c)return this._dataReady(c[0],c[1]),!1}if((c=(this.loader||"").toLowerCase())&&!JsHttpRequest.LOADERS[c])return this._error("unk_loader",c);var e=[],f=JsHttpRequest.LOADERS,g;for(g in f){var h=f[g].loader;if(h&&!(c&&g!=c)){h=new h(this);JsHttpRequest.extend(h, this._openArgs);JsHttpRequest.extend(h,{queryText:b.join("&"),queryElem:d,id:(new Date).getTime()+""+JsHttpRequest.COUNT++,hash:a,span:null});var i=h.load();if(!i)return this._ldObj=h,JsHttpRequest.PENDING[h.id]=this,!0;if(c)return this._error(i);e[e.length]="- "+g.toUpperCase()+": "+this._l(i)}}return g?this._error("no_loader_matched",e.join("\n")):this._error("no_loaders")}}};this.getAllResponseHeaders=function(){with(this)return _ldObj&&_ldObj.getAllResponseHeaders?_ldObj.getAllResponseHeaders(): []};this.getResponseHeader=function(a){with(this)return _ldObj&&_ldObj.getResponseHeader?_ldObj.getResponseHeader(a):null};this.setRequestHeader=function(a,b){with(this)_reqHeaders[_reqHeaders.length]=[a,b]};this._dataReady=function(a,b){with(this)caching&&_ldObj&&(JsHttpRequest.CACHE[_ldObj.hash]=[a,b]),responseText=responseXML=a,responseJS=b,null!==b?(status=200,statusText="OK"):(status=500,statusText="Internal Server Error"),_changeReadyState(2),_changeReadyState(3),_changeReadyState(4),_cleanup()}; this._l=function(a){for(var b=0,d=0,c=this._errors[a[0]];0<=(d=c.indexOf("%",d));)var e=a[++b]+"",c=c.substring(0,d)+e+c.substring(d+1,c.length),d=d+(1+e.length);return c};this._error=function(a){a=this._l("string"==typeof a?arguments:a);a="JsHttpRequest: "+a;if(window.Error){if("test"==Error(1,"test").description)throw Error(1,a);throw Error(a);}throw a;};this._hash2query=function(a,b,d,c){null==b&&(b="");if("object"==(""+typeof a).toLowerCase()){var e=!1;a&&a.parentNode&&a.parentNode.appendChild&& a.tagName&&"FORM"==a.tagName.toUpperCase()&&(a={form:a});for(var f in a){var g=a[f];if(!(g instanceof Function)){var h=b?b+"["+this.escape(f)+"]":this.escape(f);if(g&&g.parentNode&&g.parentNode.appendChild&&g.tagName){var i=g.tagName.toUpperCase();if("FORM"==i)e=!0;else if(!("INPUT"==i||"TEXTAREA"==i||"SELECT"==i))return this._error("inv_form_el",g.name||"",g.tagName);c[c.length]={name:h,e:g}}else if(g instanceof Object)this._hash2query(g,h,d,c);else{if(null===g)continue;!0===g&&(g=1);!1===g&&(g= "");d[d.length]=h+"="+this.escape(""+g)}if(e&&1<c.length)return this._error("must_be_single_el")}}}else d[d.length]=a;return!0};this._cleanup=function(){var a=this._ldObj;if(a){JsHttpRequest.PENDING[a.id]=!1;var b=a.span;b&&(a.span=null,JsHttpRequest.setTimeout(function(){b.parentNode.removeChild(b)},50))}};this._changeReadyState=function(a,b){with(this)b&&(status=statusText=responseJS=null,responseText=""),readyState=a,onreadystatechange&&onreadystatechange()};this.escape=function(a){return escape(a).replace(RegExp("\\+", "g"),"%2B")}}JsHttpRequest.COUNT=0;JsHttpRequest.MAX_URL_LEN=2E3;JsHttpRequest.CACHE={};JsHttpRequest.PENDING={};JsHttpRequest.LOADERS={};JsHttpRequest._dummy=function(){};JsHttpRequest.TIMEOUTS={s:window.setTimeout,c:window.clearTimeout}; JsHttpRequest.setTimeout=function(a,b){window.JsHttpRequest_tmp=JsHttpRequest.TIMEOUTS.s;if("string"==typeof a)d=window.JsHttpRequest_tmp(a,b);else{var d=null,c=function(){a();delete JsHttpRequest.TIMEOUTS[d]},d=window.JsHttpRequest_tmp(c,b);JsHttpRequest.TIMEOUTS[d]=c}window.JsHttpRequest_tmp=null;return d};JsHttpRequest.clearTimeout=function(a){window.JsHttpRequest_tmp=JsHttpRequest.TIMEOUTS.c;delete JsHttpRequest.TIMEOUTS[a];a=window.JsHttpRequest_tmp(a);window.JsHttpRequest_tmp=null;return a}; JsHttpRequest.query=function(a,b,d,c){var e=new this;e.caching=!c;e.onreadystatechange=function(){4==e.readyState&&d(e.responseJS,e.responseText)};e.open(null,a,!0);e.send(b)};JsHttpRequest.dataReady=function(a){var b=this.PENDING[a.id];delete this.PENDING[a.id];if(b)b._dataReady(a.text,a.js);else if(!1!==b)throw"dataReady(): unknown pending id: "+a.id;};JsHttpRequest.extend=function(a,b){for(var d in b)a[d]=b[d]}; JsHttpRequest.LOADERS.xml={loader:function(a){JsHttpRequest.extend(a._errors,{xml_no:"Cannot use XMLHttpRequest or ActiveX loader: not supported",xml_no_diffdom:"Cannot use XMLHttpRequest to load data from different domain %",xml_no_headers:"Cannot use XMLHttpRequest loader or ActiveX loader, POST method: headers setting is not supported, needed to work with encodings correctly",xml_no_form_upl:"Cannot use XMLHttpRequest loader: direct form elements using and uploading are not implemented"});this.load= function(){if(this.queryElem.length)return["xml_no_form_upl"];if(this.url.match(/^([a-z]+:\/\/[^\/]+)(.*)/i)&&RegExp.$1.toLowerCase()!=document.location.protocol+"//"+document.location.hostname.toLowerCase())return["xml_no_diffdom",RegExp.$1];var b=null;if(window.XMLHttpRequest)try{b=new XMLHttpRequest}catch(d){}else if(window.ActiveXObject){try{b=new ActiveXObject("Microsoft.XMLHTTP")}catch(c){}if(!b)try{b=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}}if(!b)return["xml_no"];var f=window.ActiveXObject|| b.setRequestHeader;this.method||(this.method=f&&this.queryText.length?"POST":"GET");if("GET"==this.method){if(this.queryText&&(this.url+=(0<=this.url.indexOf("?")?"&":"?")+this.queryText),this.queryText="",this.url.length>JsHttpRequest.MAX_URL_LEN)return["url_too_long",JsHttpRequest.MAX_URL_LEN]}else if("POST"==this.method&&!f)return["xml_no_headers"];this.url+=(0<=this.url.indexOf("?")?"&":"?")+"JsHttpRequest="+(a.caching?"0":this.id)+"-xml";var g=this.id;b.onreadystatechange=function(){if(b.readyState== 4){b.onreadystatechange=JsHttpRequest._dummy;a.status=null;try{a.status=b.status;a.responseText=b.responseText}catch(c){}if(a.status){try{eval("JsHttpRequest._tmp = function(id) { var d = "+a.responseText+"; d.id = id; JsHttpRequest.dataReady(d); }")}catch(d){return a._error("js_invalid",a.responseText)}JsHttpRequest._tmp(g);JsHttpRequest._tmp=null}}};b.open(this.method,this.url,!0,this.username,this.password);if(f){for(f=0;f<a._reqHeaders.length;f++)b.setRequestHeader(a._reqHeaders[f][0],a._reqHeaders[f][1]); b.setRequestHeader("Content-Type","application/octet-stream")}b.send(this.queryText);this.span=null;this.xr=b;return null};this.getAllResponseHeaders=function(){return this.xr.getAllResponseHeaders()};this.getResponseHeader=function(b){return this.xr.getResponseHeader(b)};this.abort=function(){this.xr.abort();this.xr=null}}}; JsHttpRequest.LOADERS.script={loader:function(a){JsHttpRequest.extend(a._errors,{script_only_get:"Cannot use SCRIPT loader: it supports only GET method",script_no_form:"Cannot use SCRIPT loader: direct form elements using and uploading are not implemented"});this.load=function(){this.queryText&&(this.url+=(0<=this.url.indexOf("?")?"&":"?")+this.queryText);this.url+=(0<=this.url.indexOf("?")?"&":"?")+"JsHttpRequest="+this.id+"-script";this.queryText="";this.method||(this.method="GET");if("GET"!==this.method)return["script_only_get"]; if(this.queryElem.length)return["script_no_form"];if(this.url.length>JsHttpRequest.MAX_URL_LEN)return["url_too_long",JsHttpRequest.MAX_URL_LEN];var b=this,a=document,c=null,e=a.body;window.opera?(this.span=c=a.createElement("SPAN"),c.style.display="none",e.insertBefore(c,e.lastChild),c.innerHTML="Workaround for IE.<script><\/script>",a=function(){c=c.getElementsByTagName("SCRIPT")[0];c.language="JavaScript";c.setAttribute?c.setAttribute("src",b.url):c.src=b.url}):(this.span=c=a.createElement("SCRIPT"), a=function(){c.language="JavaScript";c.setAttribute?c.setAttribute("src",b.url):c.src=b.url;e.insertBefore(c,e.lastChild)});JsHttpRequest.setTimeout(a,10);return null}}}; JsHttpRequest.LOADERS.form={loader:function(a){JsHttpRequest.extend(a._errors,{form_el_not_belong:'Element "%" does not belong to any form!',form_el_belong_diff:'Element "%" belongs to a different form. All elements must belong to the same form!',form_el_inv_enctype:'Attribute "enctype" of the form must be "%" (for IE), "%" given.'});this.load=function(){var b=this;b.method||(b.method="POST");b.url+=(0<=b.url.indexOf("?")?"&":"?")+"JsHttpRequest="+b.id+"-form";if("GET"==b.method){b.queryText&&(b.url+= (0<=b.url.indexOf("?")?"&":"?")+b.queryText);if(b.url.length>JsHttpRequest.MAX_URL_LEN)return["url_too_long",JsHttpRequest.MAX_URL_LEN];var a=b.url.split("?",2);b.url=a[0];b.queryText=a[1]||""}var c=null,e=!1;if(b.queryElem.length){if("FORM"==b.queryElem[0].e.tagName.toUpperCase())c=b.queryElem[0].e,e=!0,b.queryElem=[];else{c=b.queryElem[0].e.form;for(a=0;a<b.queryElem.length;a++){var f=b.queryElem[a].e;if(!f.form)return["form_el_not_belong",f.name];if(f.form!=c)return["form_el_belong_diff",f.name]}}if("POST"== b.method&&(a=c.attributes.encType&&c.attributes.encType.nodeValue||c.attributes.enctype&&c.attributes.enctype.value||c.enctype,"multipart/form-data"!=a))return["form_el_inv_enctype","multipart/form-data",a]}var g=c&&(c.ownerDocument||c.document)||document,h="jshr_i_"+b.id,a=b.span=g.createElement("DIV");a.style.position="absolute";a.style.display="none";a.style.visibility="hidden";a.innerHTML=(c?"":"<form"+("POST"==b.method?' enctype="multipart/form-data" method="post"':"")+"></form>")+'<iframe name="'+ h+'" id="'+h+'" style="width:0px; height:0px; overflow:hidden; border:none"></iframe>';c||(c=b.span.firstChild);g.body.insertBefore(a,g.body.lastChild);var i=function(a,b){var c=[],d=a;if(a.mergeAttributes){d=g.createElement("form");d.mergeAttributes(a,false)}for(var e=0;e<b.length;e++){var f=b[e][0],h=b[e][1];c[c.length]=[f,d.getAttribute(f)];d.setAttribute(f,h)}a.mergeAttributes&&a.mergeAttributes(d,false);return c};JsHttpRequest.setTimeout(function(){top.JsHttpRequestGlobal=JsHttpRequest;var a= [];if(!e)for(var d=0,f=c.elements.length;d<f;d++){a[d]=c.elements[d].name;c.elements[d].name=""}f=b.queryText.split("&");for(d=f.length-1;d>=0;d--){var k=f[d].split("=",2),j=g.createElement("INPUT");j.type="hidden";j.name=unescape(k[0]);j.value=k[1]!=null?unescape(k[1]):"";c.appendChild(j)}for(d=0;d<b.queryElem.length;d++)b.queryElem[d].e.name=b.queryElem[d].name;d=i(c,[["action",b.url],["method",b.method],["onsubmit",null],["target",h]]);c.submit();i(c,d);for(d=0;d<f.length;d++)c.lastChild.parentNode.removeChild(c.lastChild); if(!e){d=0;for(f=c.elements.length;d<f;d++)c.elements[d].name=a[d]}},100);return null}}};

/* OUTLOOK function */
function UpLoadAttach(a,b){document.getElementById(b).innerHTML='<img src="/js/img/loader.gif" style="vertical-align:middle" />';JsHttpRequest.query("loader.php?p=outlook&mailact1=UploadAttachment",{form:document.getElementById(a),mailact:"-"},function(a){a&&(document.getElementById(b).innerHTML=a.successmsg,document.getElementById("AFiles").innerHTML=document.getElementById("AFiles").innerHTML+" "+a.fileinfo)},!0)} function DelTmpAttach(a,b,c){document.getElementById(a).innerHTML='<img src="/js/img/loader.gif" style="vertical-align:middle" />';JsHttpRequest.query("loader.php?p=outlook&mailact1=DelTmpAttach",{file:b},function(b){b&&(document.getElementById(a).innerHTML=b.successmsg,delelem(c))},!0)} function SendMessage(a,b,c){document.getElementById(b).innerHTML='<img src="/js/img/loader.gif" style="vertical-align:middle" />';JsHttpRequest.query("loader.php?p=outlook&mailact=SendMsg&idma="+c,{form:document.getElementById(a)},function(a){a&&("ERROR"==a.state?document.getElementById(b).innerHTML=a.msg:(document.getElementById(b).innerHTML=a.msg,document.getElementById("MainFormMsg").innerHTML="",ReCount(a.countmsg,c)))},!0)} function ReCount(a,b){document.getElementById("ACount_"+b).innerHTML=a.all;document.getElementById("ICount_"+b).innerHTML=a.inb;document.getElementById("NCount_"+b).innerHTML=a["new"];document.getElementById("SCount_"+b).innerHTML=a.out;document.getElementById("TCount_"+b).innerHTML=a.trash} function DeleteMessage(a,b,c){document.getElementById("OMSGBlock").innerHTML='<img src="/js/img/loader.gif" style="vertical-align:middle" />';JsHttpRequest.query("loader.php?p=outlook",{mailact:a,idm:b,idma:c},function(a){a&&(document.getElementById("OMSGBlock").innerHTML=a.msg,delelem("tr"+b),ReCount(a.countmsg,c))},!0)} function EmptyTrash(a){document.getElementById("OMSGBlock").innerHTML='<img src="/js/img/loader.gif" style="vertical-align:middle" /> \u041e\u0447\u0438\u0441\u0442\u043a\u0430 \u043a\u043e\u0440\u0437\u0438\u043d\u044b...';JsHttpRequest.query("loader.php?p=outlook",{mailact:"EmptyTrash",idma:a},function(b){b&&(document.getElementById("OMSGBlock").innerHTML=b.msg,getdata("","post","?p=outlook&mailact=LoadMailList&folder=trash&outpage=page&idma="+a,"OMailList"),ReCount(b.countmsg,a))},!0)} function DeleteSelectedMessages(){var a=document.getElementById("CURRENT_IDMA").value,b=getElementsByClass("CHM",null,"input"),c=0;for(i=0;i<b.length;i++)!0==b[i].checked&&(document.getElementById("OMSGBlock").innerHTML='<img src="/js/img/loader.gif" style="vertical-align:middle" /> \u0423\u0434\u0430\u043b\u044f\u0435\u043c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f...',DeleteMessage("DeleteMessage",b[i].value,a),c++);0==c&&alert("\u0412\u044b \u043d\u0435 \u0432\u044b\u0431\u0440\u0430\u043b\u0438 \u043d\u0438 \u043e\u0434\u043d\u043e\u0433\u043e \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f!")} function ReplyForward(a,b){var b=document.getElementById("CURRENT_IDMA").value,c=getElementsByClass("CHM",null,"input"),d=0;for(i=0;i<c.length;i++)if(!0==c[i].checked){var e=c[i].value;d++}if(1!=d)alert("\u041e\u0442\u043c\u0435\u0442\u044c\u0442\u0435 \u043e\u0434\u043d\u043e \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u0434\u043b\u044f \u043d\u0430\u043f\u0438\u0441\u0430\u043d\u0438\u044f \u043e\u0442\u0432\u0435\u0442\u0430 \u0438\u043b\u0438 \u043f\u0435\u0440\u0435\u0441\u044b\u043b\u043a\u0438!"); else return owin=dhtmlwindow.open("WriteFormBox","inline","","\u041e\u0442\u0432\u0435\u0442\u0438\u0442\u044c \u043d\u0430 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435","width=800px,height=550px,left=50px,top=70px,resize=1,scrolling=1"),owin.moveTo("middle","middle"),getdata("","get","?p=outlook&type="+a+"&mailact=WriteForm&idm="+e+"&idma="+b,"WriteFormBox_inner"),!0} function ReadMessage(a){var b=document.getElementById("CURRENT_IDMA").value;rwin=dhtmlwindow.open("ReadMailBox","inline","","\u0427\u0442\u0435\u043d\u0438\u0435 \u043f\u0438\u0441\u044c\u043c\u0430","width=800px,height=500px,left=50px,top=70px,resize=1,scrolling=1");rwin.moveTo("middle","middle");getdata("","get","?p=outlook&mailact=LoadMessageForRead&idm="+a+"&idma="+b,"ReadMailBox_inner")} function CheckAllMsg(a,b){var c=getElementsByClass(a,null,"input"),d=b.checked;for(i=0;i<c.length;i++)!0==d?(c[i].checked=!0,document.getElementById("tr"+c[i].value).className="Omainsel"):(c[i].checked=!1,document.getElementById("tr"+c[i].value).className="Orow1 Omainbody")} function SaveUserSet(a,b){document.getElementById(b).innerHTML='<img src="/js/img/loader.gif" style="vertical-align:middle" />';JsHttpRequest.query("loader.php?p=outlook&mailact=SaveUSet",{form:document.getElementById(a)},function(a){a&&(document.getElementById(b).innerHTML=a.msg)},!0)} function SaveUserSet1(a,b){document.getElementById(b).innerHTML='<img src="/js/img/loader.gif" style="vertical-align:middle" />';JsHttpRequest.query("loader.php?p=outlook&mailact=SaveUSet1",{form:document.getElementById(a)},function(a){a&&(document.getElementById(b).innerHTML=a.msg)},!0)} function updateLoginPort(){var a=document.getElementById("mailtls").value;if("imap"==a||"notls"==a)document.getElementById("port").value=143;else if("ssl"==a||"ssl/novalidate-cert"==a)document.getElementById("port").value=993;else if("pop3"==a||"pop3/notls"==a)document.getElementById("port").value=110;else if("pop3/ssl"==a||"pop3/ssl/novalidate-cert"==a)document.getElementById("port").value=995} function SearchInContact(a){JsHttpRequest.query("loader.php?p=outlook&mailact=SearchInContact",{str:a},function(a){a&&(document.getElementById("ContactArea").innerHTML=a.msg)},!0)}function LoadIdoMessages(){JsHttpRequest.query("loader.php?p=outlook&mailact=SearchInContact",{str:str},function(a){a&&(document.getElementById("ContactArea").innerHTML=a.msg)},!0)} function CheckNewMail(a){document.getElementById("OMSGBlock").innerHTML='<img src="/js/img/loader.gif" style="vertical-align:middle" /> \u041f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u043c \u043f\u043e\u0447\u0442\u0443...';JsHttpRequest.query("loader.php?p=outlook",{mailact:"CheckNewMail",idma:a},function(b){b&&(document.getElementById("OMSGBlock").innerHTML=b.msg,ReCount(b.countmsg,a),getdata("","post","?p=outlook&mailact=LoadMailList&folder=inbox&outpage=page&idma="+a,"OMailList"),document.getElementById("CURRENT_IDMA").value= a)},!0)}function LoadUserContact(a){document.getElementById("AllUserMail").innerHTML='<img src="/js/img/loader.gif" style="vertical-align:middle" />';JsHttpRequest.query("loader.php?p=outlook",{mailact:"LoadUserContact",idu:a},function(a){a&&(document.getElementById("AllUserMail").innerHTML=a.mails)},!0)} function ApplayFilter(){var a=document.getElementById("CurFolder").value,b=document.getElementById("CURRENT_IDMA").value,c=getElementsByClass("filter",null,"input"),d="";for(i=0;i<c.length;i++)""!=c[i].value&&"text"==c[i].type&&(d=d+"&"+c[i].id+"="+c[i].value),"radio"==c[i].type&&!0==c[i].checked&&(d=d+"&"+c[i].name+"="+c[i].value);getdata("","post","?p=outlook&mailact=LoadMailList&folder="+a+"&outpage=page&idma="+b+d,"OMailList")} function LoadMailList(a,b,c){var d=getElementsByClass("filter",null,"input"),e="";for(i=0;i<d.length;i++)""!=d[i].value&&"text"==d[i].type&&(e=e+"&"+d[i].id+"="+d[i].value),"radio"==d[i].type&&!0==d[i].checked&&(e=e+"&"+d[i].name+"="+d[i].value);JsHttpRequest.query("loader.php?p=outlook"+e,{mailact:"UpdateMessageCount",idma:c},function(a){a&&ReCount(a.countmsg,c)},!0);getdata("","post","?p=outlook&mailact=LoadMailList&folder="+a+"&outpage="+b+"&idma="+c+e,"OMailList");document.getElementById("CURRENT_IDMA").value= c};

/* DHTML Window */
var dhtmlwindow={imagefiles:["js/img/min.gif","js/img/close.gif","js/img/restore.gif","js/img/resize.gif"],ajaxbustcache:true,ajaxloadinghtml:"<b>Loading Page. Please wait...</b>",minimizeorder:0,zIndexvalue:100,tobjects:[],lastactivet:{},init:function(B){var E=document.createElement("div");E.id=B;E.className="dhtmlwindow";var D="";D='<div class="drag-handle">';D+='DHTML Window <div class="drag-controls"><img src="'+this.imagefiles[0]+'" title="Minimize" /><img src="'+this.imagefiles[1]+'" title="Close" /></div>';D+="</div>";D+='<div id="'+B+'_inner" class="drag-contentarea"></div>';D+='<div class="drag-statusarea"><div class="drag-resizearea" style="background: transparent url('+this.imagefiles[3]+') top right no-repeat;">&nbsp;</div></div>';D+="</div>";E.innerHTML=D;document.getElementById("dhtmlwindowholder").appendChild(E);var B=document.getElementById(B);var C=B.getElementsByTagName("div");for(var A=0;A<C.length;A++){if(/drag-/.test(C[A].className)){B[C[A].className.replace(/drag-/,"")]=C[A]}}B.handle._parent=B;B.resizearea._parent=B;B.controls._parent=B;B.onclose=function(){return true};B.onmousedown=function(){dhtmlwindow.setfocus(this)};B.handle.onmousedown=dhtmlwindow.setupdrag;B.resizearea.onmousedown=dhtmlwindow.setupdrag;B.controls.onclick=dhtmlwindow.enablecontrols;B.show=function(){dhtmlwindow.show(this)};B.hide=function(){dhtmlwindow.hide(this)};B.close=function(){dhtmlwindow.close(this)};B.setSize=function(F,G){dhtmlwindow.setSize(this,F,G)};B.moveTo=function(F,G){dhtmlwindow.moveTo(this,F,G)};B.isResize=function(F){dhtmlwindow.isResize(this,F)};B.isScrolling=function(F){dhtmlwindow.isScrolling(this,F)};B.load=function(F,G,H){dhtmlwindow.load(this,F,G,H)};this.tobjects[this.tobjects.length]=B;return B},open:function(J,D,I,G,E,H){var F=dhtmlwindow;function B(K){var L=new RegExp(K+"=([^,]+)","i");return(L.test(E))?parseInt(RegExp.$1):0}if(document.getElementById(J)==null){J=this.init(J)}else{J=document.getElementById(J)}this.setfocus(J);J.setSize(B(("width")),(B("height")));var C=B("center")?"middle":B("left");var A=B("center")?"middle":B("top");if(typeof H!="undefined"&&H=="recal"&&this.scroll_top==0){if(window.attachEvent&&!window.opera){this.addEvent(window,function(){setTimeout(function(){J.moveTo(C,A)},400)},"load")}else{this.addEvent(window,function(){J.moveTo(C,A)},"load")}}J.isResize(B("resize"));J.isScrolling(B("scrolling"));J.style.visibility="visible";J.style.display="block";J.contentarea.style.display="block";J.moveTo(C,A);J.load(D,I,G);if(J.state=="minimized"&&J.controls.firstChild.title=="Restore"){J.controls.firstChild.setAttribute("src",dhtmlwindow.imagefiles[0]);J.controls.firstChild.setAttribute("title","Minimize");J.state="fullview"}return J},setSize:function(B,A,C){B.style.width=Math.max(parseInt(A),150)+"px";B.contentarea.style.height=Math.max(parseInt(C),100)+"px"},moveTo:function(B,A,C){this.getviewpoint();B.style.left=(A=="middle")?this.scroll_left+(this.docwidth-B.offsetWidth)/2+"px":this.scroll_left+parseInt(A)+"px";B.style.top=(C=="middle")?this.scroll_top+(this.docheight-B.offsetHeight)/2+"px":this.scroll_top+parseInt(C)+"px"},isResize:function(A,B){A.statusarea.style.display=(B)?"block":"none";A.resizeBool=(B)?1:0},isScrolling:function(A,B){A.contentarea.style.overflow=(B)?"auto":"hidden"},load:function(C,B,D,E){if(C.isClosed){alert("DHTML Window has been closed, so no window to load contents into. Open/Create the window again.");return }var B=B.toLowerCase();if(typeof E!="undefined"){C.handle.firstChild.nodeValue=E}if(B=="inline"){C.contentarea.innerHTML=D}else{if(B=="div"){var A=document.getElementById(D);C.contentarea.innerHTML=(A.defaultHTML||A.innerHTML);if(!A.defaultHTML){A.defaultHTML=A.innerHTML}A.innerHTML="";A.style.display="none"}else{if(B=="iframe"){C.contentarea.style.overflow="hidden";if(!C.contentarea.firstChild||C.contentarea.firstChild.tagName!="IFRAME"){C.contentarea.innerHTML='<iframe src="" style="margin:0; padding:0; width:100%; height: 100%" name="_iframe-'+C.id+'"></iframe>'}window.frames["_iframe-"+C.id].location.replace(D)}else{if(B=="ajax"){this.ajax_connect(D,C)}}}}C.contentarea.datatype=B},setupdrag:function(B){var C=dhtmlwindow;var A=this._parent;C.etarget=this;var B=window.event||B;C.initmousex=B.clientX;C.initmousey=B.clientY;C.initx=parseInt(A.offsetLeft);C.inity=parseInt(A.offsetTop);C.width=parseInt(A.offsetWidth);C.contentheight=parseInt(A.contentarea.offsetHeight);if(A.contentarea.datatype=="iframe"){A.style.backgroundColor="#F8F8F8";A.contentarea.style.visibility="hidden"}document.onmousemove=C.getdistance;document.onmouseup=function(){if(A.contentarea.datatype=="iframe"){A.contentarea.style.backgroundColor="white";A.contentarea.style.visibility="visible"}C.stop()};return false},getdistance:function(B){var C=dhtmlwindow;var A=C.etarget;var B=window.event||B;C.distancex=B.clientX-C.initmousex;C.distancey=B.clientY-C.initmousey;if(A.className=="drag-handle"){C.move(A._parent,B)}else{if(A.className=="drag-resizearea"){C.resize(A._parent,B)}}return false},getviewpoint:function(){var B=document.all&&!window.opera;var A=document.documentElement&&parseInt(document.documentElement.clientWidth)||100000;this.standardbody=(document.compatMode=="CSS1Compat")?document.documentElement:document.body;this.scroll_top=(B)?this.standardbody.scrollTop:window.pageYOffset;this.scroll_left=(B)?this.standardbody.scrollLeft:window.pageXOffset;this.docwidth=(B)?this.standardbody.clientWidth:(/Safari/i.test(navigator.userAgent))?window.innerWidth:Math.min(A,window.innerWidth-16);this.docheight=(B)?this.standardbody.clientHeight:window.innerHeight},rememberattrs:function(A){this.getviewpoint();A.lastx=parseInt((A.style.left||A.offsetLeft))-dhtmlwindow.scroll_left;A.lasty=parseInt((A.style.top||A.offsetTop))-dhtmlwindow.scroll_top;A.lastwidth=parseInt(A.style.width)},move:function(A,B){A.style.left=dhtmlwindow.distancex+dhtmlwindow.initx+"px";A.style.top=dhtmlwindow.distancey+dhtmlwindow.inity+"px"},resize:function(A,B){A.style.width=Math.max(dhtmlwindow.width+dhtmlwindow.distancex,150)+"px";A.contentarea.style.height=Math.max(dhtmlwindow.contentheight+dhtmlwindow.distancey,100)+"px"},enablecontrols:function(B){var C=dhtmlwindow;var A=window.event?window.event.srcElement:B.target;if(/Minimize/i.test(A.getAttribute("title"))){C.minimize(A,this._parent)}else{if(/Restore/i.test(A.getAttribute("title"))){C.restore(A,this._parent)}else{if(/Close/i.test(A.getAttribute("title"))){C.close(this._parent)}}}return false},minimize:function(B,A){dhtmlwindow.rememberattrs(A);B.setAttribute("src",dhtmlwindow.imagefiles[2]);B.setAttribute("title","Restore");A.state="minimized";A.contentarea.style.display="none";A.statusarea.style.display="none";if(typeof A.minimizeorder=="undefined"){dhtmlwindow.minimizeorder++;A.minimizeorder=dhtmlwindow.minimizeorder}A.style.left="10px";A.style.width="200px";var C=A.minimizeorder*10;A.style.top=dhtmlwindow.scroll_top+dhtmlwindow.docheight-(A.handle.offsetHeight*A.minimizeorder)-C+"px"},restore:function(B,A){dhtmlwindow.getviewpoint();B.setAttribute("src",dhtmlwindow.imagefiles[0]);B.setAttribute("title","Minimize");A.state="fullview";A.style.display="block";A.contentarea.style.display="block";if(A.resizeBool){A.statusarea.style.display="block"}A.style.left=parseInt(A.lastx)+dhtmlwindow.scroll_left+"px";A.style.top=parseInt(A.lasty)+dhtmlwindow.scroll_top+"px";A.style.width=parseInt(A.lastwidth)+"px"},close:function(B){try{var A=B.onclose()}catch(C){var A=true}finally{if(typeof A=="undefined"){alert('An error has occured somwhere inside your "onclose" event handler');var A=true}}if(A){if(B.state!="minimized"){dhtmlwindow.rememberattrs(B)}if(window.frames["_iframe-"+B.id]){window.frames["_iframe-"+B.id].location.replace("about:blank")}else{B.contentarea.innerHTML=""}B.style.display="none";B.isClosed=true}return A},setopacity:function(A,B){if(!A){return }if(A.filters&&A.filters[0]){if(typeof A.filters[0].opacity=="number"){A.filters[0].opacity=B*100}else{A.style.filter="alpha(opacity="+B*100+")"}}else{if(typeof A.style.MozOpacity!="undefined"){A.style.MozOpacity=B}else{if(typeof A.style.opacity!="undefined"){A.style.opacity=B}}}},setfocus:function(A){this.zIndexvalue++;A.style.zIndex=this.zIndexvalue;A.isClosed=false;this.setopacity(this.lastactivet.handle,0.5);this.setopacity(A.handle,1);this.lastactivet=A},show:function(A){if(A.isClosed){alert("DHTML Window has been closed, so nothing to show. Open/Create the window again.");return }if(A.lastx){dhtmlwindow.restore(A.controls.firstChild,A)}else{A.style.display="block"}this.setfocus(A);A.state="fullview"},hide:function(A){A.style.display="none"},ajax_connect:function(A,B){var E=false;var D="";if(window.XMLHttpRequest){E=new XMLHttpRequest()}else{if(window.ActiveXObject){try{E=new ActiveXObject("Msxml2.XMLHTTP")}catch(C){try{E=new ActiveXObject("Microsoft.XMLHTTP")}catch(C){}}}else{return false}}B.contentarea.innerHTML=this.ajaxloadinghtml;E.onreadystatechange=function(){dhtmlwindow.ajax_loadpage(E,B)};if(this.ajaxbustcache){D=(A.indexOf("?")!=-1)?"&"+new Date().getTime():"?"+new Date().getTime()}E.open("GET",A+D,true);E.send(null)},ajax_loadpage:function(B,A){if(B.readyState==4&&(B.status==200||window.location.href.indexOf("http")==-1)){A.contentarea.innerHTML=B.responseText}},stop:function(){dhtmlwindow.etarget=null;document.onmousemove=null;document.onmouseup=null},addEvent:function(B,C,A){var A=(window.addEventListener)?A:"on"+A;if(B.addEventListener){B.addEventListener(A,C,false)}else{if(B.attachEvent){B.attachEvent(A,C)}}},cleanup:function(){for(var A=0;A<dhtmlwindow.tobjects.length;A++){dhtmlwindow.tobjects[A].handle._parent=dhtmlwindow.tobjects[A].resizearea._parent=dhtmlwindow.tobjects[A].controls._parent=null}window.onload=null}};document.write('<div id="dhtmlwindowholder"><span style="display:none">.</span></div>');window.onunload=dhtmlwindow.cleanup;

/* DropDown Menu */
stuHover=function(){for(var b,d,a=0;a<document.styleSheets.length;a++)for(var c=0;c<document.styleSheets[a].rules.length;c++)b=document.styleSheets[a].rules[c],-1!=b.selectorText.indexOf("LI:hover")&&(d=b.selectorText.replace(/LI:hover/gi,"LI.iehover"),document.styleSheets[a].addRule(d,b.style.cssText));b=document.getElementById("nav").getElementsByTagName("LI");for(a=0;a<b.length;a++)b[a].onmouseover=function(){this.className+=" iehover"},b[a].onmouseout=function(){this.className=this.className.replace(/ iehover\b/, "")}};window.attachEvent&&window.attachEvent("onload",stuHover);